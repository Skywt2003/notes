# Python 学习笔记

[toc]

## 基本概念

Python 是一种解释型语言。

### 交互式编程

在交互模式中，最后被输出的表达式结果被赋值给变量 `_` 。可以直接取用。

### 解释器

Python 解释器不止一种，有 CPython、IPython、Jython、PyPy 等。

- CPython 用 C 语言开发，是官方标准实现，拥有良好的生态，所以应用也最为广泛。
- IPython 是在 CPython 的基础之上在交互式方面得到增强的解释器（http://ipython.org/）。
- Jython 是专为 Java 平台设计的 Python 解释器（http://www.jython.org/），它把 Python 代码编译成 Java 字节码执行。
- PyPy 是 Python 语言（2.7.13 和 3.5.3）的一种快速、兼容的替代实现（http://pypy.org/），以速度快著称。

## 语句格式

- **源码编码：**默认情况下，Python 3 源码文件以 UTF-8 编码，所有字符串都是 unicode 字符串。
- **注释：**单行注释 `#` 开头，多行注释可用 `'''` 或者 `"""` 标记。
- **缩进：**以相同的缩进表示相同的代码块。
- **多行语句：**反斜杠可以用于语句的换行。括号中的换行无需反斜杠。
- **同行语句：**同一行显示多条语句，用分号 `;` 分隔。

## 变量与数据类型

- **声明：**变量无需声明。赋值即被创建。但是使用之前必须被创建，否则报错。
- **删除对象：**可以使用 `del` 语句删除一些对象。
- **赋值：**可以为多个变量赋值多个变量：`a, b, c = 1, 2, "runoob"`。

### 对象类型（存储结构）

- **类型：**变量本身没有类型。对象才有类型。我们所说的"类型"是变量所指的内存中对象的类型。
- **可变性：**`strings`，`tuples` 和 `numbers` 是不可更改的对象，而 `list`，`dict` 和 `set` 则是可以修改的对象。
  - **不可变类型：**变量赋值 `a=5` 后再赋值 `a=10`，这里实际是新生成一个 `int` 值对象 `10`，再让 `a` 指向它，而 `5` 被丢弃，不是改变 `a` 的值。
  - **可变类型：**变量赋值 `la=[1,2,3,4]` 后再赋值 `la[2]=5` 则是将 `list la` 的第三个元素值更改，本身 `la` 没有动，只是其内部的一部分值被修改了。
- **类型判断：**`type()` 返回变量的数据类型。`isinstance(a, int)` 返回变量 a 是否为 int 类型。
  - 不同之处：`type()` 不会认为子类是一种父类类型，而 `isinstance()` 会。

#### 数字 Number

- **`int`：**整数。可以直接用十六进制 `0x123` / 八进制 `0o123` 代表。
- **`bool`：**布尔：是一种 `int` 的子类。`True==1`，`False==0`。
- **`float`：**浮点数。也可用科学计数法表示。
- **`complex`：**复数。
  - 用 j 表示虚数单位。如 `1+2j`。
- **基本运算：**`+-*/%`。`//`：整除，`**`：乘方。
- **转换：**`int()`，`float()`，`complex(x,y=0)`

#### 字符串 String

- 不分「字符」和「字符串」，不分单引号和双引号。Python 3 中所有字符串都是 Unicode 字符串。
- **多行字符串：**三引号 `'''` 可以指定一个多行字符串。
- **转义：**转义符为 `\`，规则和 C++ 类似。在前引号（包括三引号）前加 `r` 使得这个字符串不转义。
- **运算：**可以用 `+` 连接或者直接连接 `"a" "b" => "ab"` ，用 `*` 重复。
- **索引：**从左往右从 0 开始，从右往左从 -1 开始。索引出的值不能改变（赋值）。
- **截取：**`s1[a:b]` 截取下标 a 到 b 的子串，不含 b。**左闭右开。**
- **转换：**`str(x)` 将 x 转换为字符串。
- **格式化字符串：**类似 C++ 中的 printf，使用 `%` 连接，如：`print ("我叫 %s 今年 %d 岁!" % ('小明', 10))`。
- **f-string：**字面量格式化字符串，前引号前加上 f 则可使用。
  - 可以在变量中用 `{name} ` 引用 name 变量。
  - 可以使用 `=` 符号来拼接运算表达式与结果（Python 3.8）：`f'{x+1}'` 为 `2`，`f'{x+1=}'` 为 `x+1=2`。

#### 列表 List

- 定义在中括号里：`[1, 2, 'a', 1+2j, 1.3]`。
- 也可以索引和截取，也可以 `+` 连接 `*` 重复，和字符串类似。
  - 截取可以接受第三个参数表示步长。`a1[a:b:c]` 表示从 a 到 b 位置，每 c 个字符取一个。为负数则表示逆向截取。
- 索引出的元素可以改变。
- 可以进行相加操作，添加到尾端。
- **转换：**`list(x)`。
- 可以使用 `append()` 方法来添加列表项到尾部。
- 可以使用 `del` 语句来删除列表的的元素。`del list[2]` 删除下标为 2 的元素。

#### 元组 Tuple

- 定义在小括号里：`(1, 2, 'a', 'b')`。
- 与列表类似，但是元素不能更改。
- 可以把字符串看成一种特殊的元组。
- 定义只含有一个元素的元组，需要在元素后加逗号：`tup2 = (20,)`。
- **转换：**`tuple(x)`。

#### 集合 Set

- 用大括号 `{1, 2, 3, 'a'}` 或者 `set(‘a’)` 来创建。没有重复元素。
  - 空集合只能用 `set()` 创建，`{}` 会创建一个字典。
- 无序，不能有重复元素出现
- **运算：**可以进行差集 `-`、并集 `|`、交集 `&`、取不同时存在的元素集 `^` 运算。
- **转换：**`set(s)` 转换为可变集合，`frozenset(s)` 转换为不可变集合。
- **基本操作：**`s.add(x)`，`s.remove(x)`，`s.discard(x)`，`s.pop()`。
  - `s.remove(x)` 如果 x 不存在会报错，`s.discard(x)` 则不会。
  - `s.pop()` 随机删除集合中的一个元素。

#### 字典 Dictionary

- 是一个无序的键（key）：值（value）的集合。键必须使用不可变类型，必须唯一。
  - 如果一个键被赋值两次，后面的会覆盖前面的。
  - 键必须用不可变类型。可以用数字、字符串、元组，列表就不行。
- **构造：**用大括号 `{'a': 5, 'b': 7, 'c': 0}` 或者 `dict()` 函数构造一个字典。
  - 构造函数 `dict()` 可以直接从键值对序列中构建字典：`dict(a=5, b=7, c=0)` 或者 `dict([('a', 5), ('b', 7), ('c', 0)])`
- **创建空字典：**`{}`。
- **删除操作：**`del dict['Name']` 删除键，`dict.clear()` 清空字典，`del dict` 删除字典。

### 运算符

- **等号：**和 C++ 一样用 `==` 判断，用 `=` 赋值。
- **海象运算符：**`:= ` 可在表达式内部为变量赋值。**Python3.8 版本新增运算符**。
- **位运算符：**`& | ^ ~ << >>`。
- **逻辑运算符：**`and or not`。
- **成员运算符：**`in`：如果在指定的序列中找到值返回 True，否则返回 False。亦有 `not in`。
- **身份运算符：**身份运算符用于比较两个对象的存储单元。`is` 判断两个标识符是不是引用自一个对象，`x is y` 类似 `id(x) == id(y)`。亦有 `is not`。

## 基本语句

### Import 导入模块

- **整个导入：**将整个模块 `somemodule` 导入，格式为：`import somemodule`

- **部分导入：**从某个模块中导入某个/些函数，格式为：`from somemodule import somefunction (, secfunc, ...)`

### if 分支语句

````python
if condition_1:
    statement_block_1
elif condition_2:
    statement_block_2
else:
    statement_block_3
````

### while 循环语句

```python
while condition:
    statements...
```

### for 循环语句

```python
for <variable> in <sequence>:
    <statements>
else:
    <statements>
```

`else` 分支指示没有循环元素的情况下执行的语句。

#### range() 函数

- `range(a)`：生成 `[0,a-1]` 的数列。
- `range(a,b)`：生成 `[a,b-1]` 的数列。
- `range(a,b,c)`：生成 `[a,b-1]` 内步长为 c 的序列。

可以用 `range()` 创建列表/元组：`list(range(a))`。默认返回元组。

### 循环控制

Python 的循环语句也支持 `continue` 和 `break`。

### 占位语句

`pass` 语句什么都不做，可以用于占位。

## 函数

### 函数的定义

- 以 `def` 开头；括号是必须的，参数写在括号内，无需定义参数类型；括号后接冒号 `:`。
  - 关于「类型」：「在 Python 中，类型属于对象，变量是没有类型的。」
- 可以在函数内第一行留一个文档字符串，类似注释。
- return 返回值，没有 return 则默认返回 `None`。

```python
def max(a, b):
    "函数_文档字符串"
	if a > b:
		return a
	else:
		return b
```

#### 关于传入对象

传入不可变对象类似值传递（同一个对象），传入可变对象类似引用传递。

#### 参数

##### 必需参数

必需参数须以正确的顺序传入函数，否则会发生错误。

##### 关键字参数

使用关键字参数允许函数调用时参数的顺序与声明时不一致，Python 解释器能够用参数名匹配参数值。

```python
def printme(str):
    ...
printme(str = "someStr")
```

##### 默认参数

函数定义时可以定义未给出参数情况下的默认值。

```python
def printinfo(name, age = 35):
    ...
printinfo(name = "someStr")
```

##### 不定长参数

你可能需要一个函数能处理比当初声明时更多的参数。这些参数叫做不定长参数，声明时不会命名。

加了星号 `*` 的参数会以元组的形式导入，存放所有未命名的变量参数。也可以不提供这些参数，元组会为空。

```python
def printinfo(arg1, *vartuple):
   "打印任何传入的参数"
   print (arg1)
   print (vartuple)

printinfo(70, 60, 50)
```

加两个星号 `**` 的参数会以字典形式导入。

```python
def printinfo(arg1, **vardict):
   "打印任何传入的参数"
   print (arg1)
   print (vardict)

printinfo(1, a=2, b=3)
```

单独出现的星号 `*` 后的参数必须用关键字传入。

```python
def f(a,b,*,c):
    return a+b+c

f(1,2,3)   # 错误
f(1,2,c=3) # 正确
```

##### 强制位置参数

Python3.8 新增了一个函数形参语法 `/` 用来指明函数形参必须使用指定位置参数，表示不能使用关键字参数的形式。

在以下的例子中，形参 a 和 b 必须使用指定位置参数，c 或 d 可以是位置形参或关键字形参，而 e 和 f 要求为关键字形参:

```python
def f(a, b, /, c, d, *, e, f):
    print(a, b, c, d, e, f)
```

以下使用方法是正确的:

```python
f(10, 20, 30, d=40, e=50, f=60)
```

以下使用方法会发生错误:

```python
f(10, b=20, c=30, d=40, e=50, f=60)   # b 不能使用关键字参数的形式
f(10, 20, 30, 40, 50, f=60)           # e 必须使用关键字参数的形式
```

### 匿名函数

使用 lambda 来创建匿名函数。

- lambda 的主体是一个表达式，而不是一个代码块。仅仅能在lambda表达式中封装有限的逻辑进去。
- lambda 函数拥有自己的命名空间，且不能访问自己参数列表之外或全局命名空间里的参数。

#### 语法

```python
func = lambda [arg1 [,arg2,.....argn]]:expression
```

例子：

```python
sum = lambda arg1, arg2: arg1 + arg2
a = sum(10, 20)
```

### 常用的内建函数

#### 数学函数

- `ceil(x)` 返回向上取整结果。
- `round(x[, n])`：返回浮点数 x 的四舍五入值，如给出 n 值，则代表舍入到小数点后的位数。

#### 随机数函数

- Python 会自动选择 seed，也可以用 `seed([x])` 手动设定/要求更改。
- `random()` 生成 $[0,1)$ 的一个实数。
- `choice(seq)`：从序列中随机挑选一个元素。
- `randrange([start, ]stop[, step])`：从指定范围内，按指定基数递增的集合中（类似切片）获取一个随机数。
- `shuffle(lst)` 洗牌。

#### 输入输出函数

- 输入：`input()` 返回输入的值。
  - 提供字符串作为参数，则先输出字符串再等待用户输入。
- 输出：`print()`。输出的内容作为参数。
  - 默认结尾输出一个回车，可用 `print('  ',end='')`。

#### 系统类函数

- `id(x)` 输出 x 对象对应的内存地址。

